const MAPS = [
    {
        width:25,
        height:10,
        tileset:"grassland",
        data:[
            -1,-1,-1,-1,18,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
            -1,-1,-1,-1,18,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
            -1,-1,-1,-1,18,-1,-1,-1,-1,-1,-1,-1,-1,-1,17,-1,-1,-1,-1,15,25,-1,-1,-1,-1,
            -1,-1,-1,-1,-1,-1,-1,-1,-1,18,18,-1,-1,-1,-1,-1,-1,-1,18,09,10,-1,-1,-1,-1,
            -1,-1,-1,-1,-1,-1,-1,-1,18,-1,-1,18,-1,-1,-1,-1,-1,18,09,00,00,10,-1,-1,20,
            -1,22,-1,-1,19,-1,23,-1,-1,-1,-1,-1,-1,24,-1,15,-1,09,00,00,00,00,10,14,-1,
            07,07,07,07,07,07,07,07,10,-1,-1,09,07,07,07,07,07,00,00,00,00,00,00,07,07,
            00,00,00,00,00,00,00,00,02,-1,-1,16,00,00,00,00,00,00,00,00,00,00,00,00,00,
            00,00,00,00,00,00,00,00,02,-1,-1,16,00,00,00,00,00,00,00,00,00,00,00,00,00,
            01,01,01,01,01,01,01,01,05,-1,-1,04,01,01,01,01,01,01,01,01,01,01,01,01,01
        ],
        playerspawn:{x:0,y:400},
    },
    {
        width:25,
        height:10,
        tileset:"grassland",
        data:[
            -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
            -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,29,-1,
            -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,18,18,-1,-1,-1,
            -1,-1,-1,-1,-1,-1,-1,-1,-1,18,18,-1,-1,-1,-1,-1,-1,-1,-1,09,07,07,07,07,07,
            -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,27,-1,-1,-1,-1,09,07,00,00,00,00,00,00,
            -1,-1,26,-1,21,21,-1,-1,-1,-1,-1,09,10,-1,-1,-1,28,16,00,00,00,00,00,00,00,
            07,07,07,07,07,07,07,07,10,-1,-1,16,00,07,07,07,07,00,00,00,00,00,00,00,00,
            00,00,00,00,00,00,00,00,02,21,21,16,00,00,00,00,00,00,00,00,00,00,00,00,00,
            00,00,00,00,00,00,00,00,00,07,07,00,00,00,00,00,00,00,00,00,00,00,00,00,00,
            01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01
        ],
        playerspawn:{x:0,y:500},
    },
    {
        width:40,
        height:10,
        tileset:"grassland",
        data:[
            -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,18,18,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
            -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
            -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,21,21,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
            -1,-1,-1,18,18,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,09,07,07,10,-1,-1,-1,-1,-1,-1,30,-1,-1,-1,-1,-1,
            -1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,17,-1,-1,-1,-1,-1,-1,17,-1,-1,16,00,00,02,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
            -1,-1,-1,21,21,-1,-1,21,-1,-1,21,-1,-1,17,17,17,-1,-1,28,-1,-1,17,17,09,00,00,00,02,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,
            07,07,07,07,07,07,07,07,07,07,07,07,07,07,07,07,07,07,07,07,07,07,07,00,00,00,00,00,07,07,07,07,07,07,07,07,07,07,07,07,
            00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,
            00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,
            00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,
        ],
        playerspawn:{x:0,y:500},
    }
];

current_map=undefined;
player=new playerSprite(0,0);

function load_map(map,xOffset,yOffset,noReset){
    if(!noReset){
        sprites=[];
    }
    if(xOffset===undefined){xOffset=0;}
    if(yOffset===undefined){yOffset=0;}
    
    var tileset=tilesets[map.tileset];
    
    for(var y=0;y<map.height;y++){
        for(var x=0;x<map.width;x++){
            if(map.data[y*map.width+x]!=-1){
                new tileset[map.data[y*map.width+x]](x*TILE_SIZE+xOffset,y*TILE_SIZE+yOffset)
            }
        }
    }
    player=new playerSprite(0,0);
    player.xv=0;
    player.yv=0;
    player.x=map.playerspawn.x;
    player.y=map.playerspawn.y;
    
    scrn["scroll-locks-x"]=[];
    scrn["scroll-locks-y"]=[];
    
    scrn["scroll-locks-x"].push({pos:0,block:"right"});
    scrn["scroll-locks-x"].push({pos:(xOffset+map.width*TILE_SIZE)-width,block:"left"});
    scrn["scroll-locks-y"].push({pos:(yOffset+map.height*TILE_SIZE)-height,block:"down"});
    if(map.onload!==undefined){
        map.onload();
    }
    current_map=map;
}
    

function death(){
    window.setTimeout(function(){
        load_map(current_map,0,0);
        SCORE=0;
    },5);
}

load_map(MAPS[0],0,0)

//new crate(0,100);new crate(100,100);